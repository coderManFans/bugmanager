(function(a){a.fn.extend({gAuto:function(i){var c=a.extend(true,{},a.fn.gAuto.defaults,i);var k=0;var w=0;var u;var p;var m=true;var r;var s;var j=f();var n;var l=a("#autoTipImg");a(this).off(".autoComplete").on("keydown.autoComplete keyup.autoComplete blur.autoComplete",function(z){u=a(this);if(u.attr("readonly")){return}p=u.siblings("input.autoHidden");o();var y=z.which;var x=z.type;if(x=="keydown"&&j[0].style.display!="none"){t(y,z)}if(x=="keyup"){if(z.ctrlKey||z.shiftKey||y==a.gAuto.keyCode.SHIFT){return}e(y)}if(x=="blur"&&m){u.val()==""&&d("");j.hide()}});function q(A,z){var y=u.val().trim();var x=u.attr("autoFlag");a.ajax({type:"POST",url:z,dataType:"json",data:{keyword:y,flag:x,isShowAll:A},error:function(){l.html("<span class='auo-text-warn'>数据返回错误！</span>")},success:function(B){if(B!=""){w=B.length;if(w>10){j.css({height:j.height(),overflowY:"scroll"})}l[0].innerHTML=h(B,y,A);n=j.find("div.item-div");j.show();u.focus();g();k=0;r=n.eq(0);v(undefined,r)}else{l.html("<span class='auo-text-warn'>未找到匹配数据！</span>");w=0}}})}function o(){j.removeClass().addClass(u.attr("divClass")==undefined?"div-auto":u.attr("divClass")).css({left:u.offset().left,top:u.offset().top+u.outerHeight(),height:"240px",overflowY:"auto",paddingLeft:0});var x="0";var y="0";if(u.css("paddingLeft")!=undefined){x=u.css("paddingLeft").replace("px","")}if(u.css("paddingRight")!=undefined){y=u.css("paddingRight").replace("px","")}var z=parseFloat(u.width())+parseFloat(x)+parseFloat(y);j.width()<z&&j.width(z)}function e(y){if(u.val()!=""){if(y!=a.gAuto.keyCode.RIGHT&&y!=a.gAuto.keyCode.DOWN&&y!=a.gAuto.keyCode.LEFT&&y!=a.gAuto.keyCode.UP&&y!=a.gAuto.keyCode.ENTER&&y!=a.gAuto.keyCode.CONTROL&&y!=a.gAuto.keyCode.TAB){d("");j[0].style.display=="none"&&j.show();l.html("<span class='auo-text-loading'>正在获取数据……</span>");var x=u.attr("reqUrl");q(false,x==undefined?c.url:x)}}else{j.hide();d("")}}function t(x,y){if(x==a.gAuto.keyCode.RIGHT||x==a.gAuto.keyCode.DOWN){k=k+1>=w?0:k+1;s=n.eq(k);v(r,s);j.scrollTop((k-11)*20)}if(x==a.gAuto.keyCode.LEFT||x==a.gAuto.keyCode.UP){k=k<1?w-1:k-1;s=n.eq(k);v(r,s);j.scrollTop((k-11)*20)}if(x==a.gAuto.keyCode.ENTER||x==a.gAuto.keyCode.TAB){y.preventDefault();s=r;w!=0&&v(undefined,r,true);j.hide()}r=s}function g(){a("#isShowAll").off(".autoComplete").on("mousedown.autoComplete",function(){l.html("<span class='auo-text-loading'>正在获取数据……</span>");q(true,c.url)});n.hover(function(){r=a(this);v(n.eq(k),r);k=n.index(this)},function(){v(a(this))}).off(".autoComplete").on("mousedown.autoComplete",function(){v(undefined,a(this),true);j.hide()})}function h(B,y,C){var A="";for(var z=0;z<B.length;z++){var x=B[z].name.replace(new RegExp(y,"i"),"<b><span style='color:red'>$&</span></b>");A=A+"<div class='item-div' strId='"+B[z].id+"'>"+x+"</div>"}if(!C){A=A+"<div class='show-all-div'><a id='isShowAll' class='btn blue'>显示全部</a></div>"}return A}function v(y,z,x){y&&y.css({"background":"#FFFFFF"});if(z!==undefined){z.css({background:"#FBEC88"});if(x){u.val(z.text());d(z.attr("strId"))}}}function d(x){u.setGAutoHiddenValue(x);p.val(x);if(c.selectedCallback){c.selectedCallback(u,p)}}function f(){if(a("#autoTipDiv").size()==0){a("body").append("<div id='autoTipDiv' class='auto-tip-div'>"+'<iframe style="position:absolute; z-index:-1;width:110px;" frameborder="0" src="about:blank"></iframe>'+"<div id='autoTipImg'></div>"+"</div>")}return a("#autoTipDiv").hover(function(){m=false},function(){m=true}).off(".autoComplete").on("scroll.autoComplete",function(){u&&u.focus()})}return this},getGAutoHiddenValue:function(){return this.data("hiddenValue")},setGAutoHiddenValue:function(c){return this.data("hiddenValue",c)}});var b=(function(){var d=window.location+"";var e=d.split("//");var c=e[1].split("/");return e[0]+"//"+window.location.host+"/"+c[1]+"/"})();a.fn.gAuto.defaults={selectedCallback:null,url:b+"autoComplete"};a.gAuto=function(){a("input.gAuto").gAuto()};a.gAuto.keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,F7:118,F12:123,S:83,WINDOWS:91}})(jQuery);$(function(){$.gAuto()});